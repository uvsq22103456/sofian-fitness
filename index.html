<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>SOFIAN.FIT</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Inter:wght@400;600;800&display=swap');
        :root { --bg: #000000; --card: #0d0d0d; --accent: #ff003c; --blue: #0084ff; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: white; height: 100dvh; overflow: hidden; display: flex; flex-direction: column; }
        .font-sport { font-family: 'Orbitron', sans-serif; }
        .view-container { flex: 1; overflow-y: auto; padding-bottom: 200px !important; }
        .glass { background: rgba(0,0,0,0.8); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); }
        
        /* CALENDRIER FRANCAIS */
        .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; }
        .cal-day { aspect-ratio: 1/1; border-radius: 10px; background: #151515; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 11px; font-weight: 800; border: 1px solid transparent; position: relative; }
        .cal-day.active { border-color: var(--accent); background: rgba(255,0,60,0.1); }
        .cal-today { color: var(--accent); text-decoration: underline; }
        .event-dot { width: 4px; height: 4px; background: var(--blue); border-radius: 50%; position: absolute; bottom: 4px; }

        /* INPUTS ESTH√âTIQUES */
        input, select { background: transparent !important; border: none !important; border-bottom: 1px solid rgba(255,255,255,0.2) !important; color: white !important; padding: 10px 0 !important; width: 100%; outline: none !important; font-size: 15px; }
        input:focus { border-bottom-color: var(--accent) !important; }
        
        .card { background: var(--card); border-radius: 20px; border: 1px solid rgba(255,255,255,0.05); padding: 20px; }
        .btn-add { background: var(--accent); color: black; font-weight: 800; text-transform: uppercase; padding: 14px; border-radius: 12px; width: 100%; margin-top: 15px; font-size: 12px; }
        .nav-item { opacity: 0.3; transition: 0.3s; }
        .nav-active { opacity: 1; color: var(--accent); }
    </style>
</head>
<body>

    <header class="pt-12 pb-4 px-6 glass sticky top-0 z-50 flex justify-between items-center">
        <div>
            <h1 class="font-sport text-lg italic italic">SOFIAN<span class="text-rose-600">.FIT</span></h1>
            <p id="quote" class="text-[8px] font-bold opacity-50 uppercase tracking-widest">Allez Sofian, on l√¢che rien !</p>
        </div>
        <div class="bg-rose-600/10 text-rose-500 px-3 py-1 rounded-full font-sport text-[10px]" id="current-month">F√©v. 2026</div>
    </header>

    <main class="view-container p-4 space-y-6">

        <section id="view-cal" class="space-y-4">
            <div class="card">
                <div class="cal-grid text-[9px] font-black opacity-30 uppercase mb-2 text-center">
                    <span>Lun</span><span>Mar</span><span>Mer</span><span>Jeu</span><span>Ven</span><span>Sam</span><span>Dim</span>
                </div>
                <div id="calendar-body" class="cal-grid text-center"></div>
            </div>

            <div class="card space-y-4">
                <h3 class="text-xs font-black text-blue-500 uppercase italic">Programmer le <span id="target-date">--</span></h3>
                <div class="grid grid-cols-2 gap-4">
                    <input type="time" id="plan-time" value="18:00">
                    <select id="plan-type">
                        <option value="Courir üèÉ">COURIR</option>
                        <option value="Muscu üèãÔ∏è">MUSCU</option>
                        <option value="Cardio üî•">CARDIO</option>
                    </select>
                </div>
                <input type="text" id="plan-desc" placeholder="D√©tails (ex: For√™t, 45min, Jambes...)">
                <button onclick="saveEvent()" class="btn-add">Ajouter au planning</button>
            </div>

            <div id="day-events" class="space-y-2"></div>
        </section>

        <section id="view-junk" class="hidden space-y-4">
            <div class="card border-l-4 border-rose-600">
                <h2 class="text-xs font-black opacity-40 uppercase">Cheat Meals Hebdo (Max 2)</h2>
                <div class="text-4xl font-sport my-2" id="junk-count">0</div>
                <input type="text" id="junk-name" placeholder="Qu'est-ce que tu as mang√© ?">
                <button onclick="addJunk()" class="btn-add">Enregistrer le craquage</button>
            </div>
            <div id="junk-history" class="space-y-2"></div>
        </section>

    </main>

    <nav class="glass fixed bottom-0 w-full z-50 pt-4 pb-10 px-10 flex justify-around items-center border-t border-white/5">
        <button onclick="showTab('cal', this)" class="nav-item nav-active flex flex-col items-center">
            <span class="text-xl">üìÖ</span>
            <span class="text-[8px] font-bold mt-1 uppercase">Planning</span>
        </button>
        <button onclick="showTab('junk', this)" class="nav-item flex flex-col items-center">
            <span class="text-xl">üçî</span>
            <span class="text-[8px] font-bold mt-1 uppercase">Cheat</span>
        </button>
    </nav>

    <script>
        // DONN√âES SAUVEGARD√âES
        let db = JSON.parse(localStorage.getItem('sofian_ultra_db')) || {
            events: {}, // "YYYY-MM-DD": [{time, type, desc}]
            junk: []    // [{date, name}]
        };

        let selectedDate = new Date().toISOString().split('T')[0];

        function save() { 
            localStorage.setItem('sofian_ultra_db', JSON.stringify(db)); 
            render(); 
        }

        function showTab(id, btn) {
            document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
            document.getElementById('view-' + id).classList.remove('hidden');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('nav-active'));
            btn.classList.add('nav-active');
        }

        function saveEvent() {
            const time = document.getElementById('plan-time').value;
            const type = document.getElementById('plan-type').value;
            const desc = document.getElementById('plan-desc').value;
            if(!desc) return alert("Pr√©cise ce que tu vas faire !");
            
            if(!db.events[selectedDate]) db.events[selectedDate] = [];
            db.events[selectedDate].push({ time, type, desc });
            document.getElementById('plan-desc').value = "";
            save();
        }

        function addJunk() {
            const name = document.getElementById('junk-name').value;
            if(!name) return;
            db.junk.push({ date: new Date().toISOString().split('T')[0], name: name });
            document.getElementById('junk-name').value = "";
            save();
        }

        function render() {
            // Rendu du Calendrier
            const body = document.getElementById('calendar-body');
            body.innerHTML = "";
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const offset = firstDay === 0 ? 6 : firstDay - 1;

            for(let i=0; i<offset; i++) body.innerHTML += `<div></div>`;
            
            for(let d=1; d<=daysInMonth; d++) {
                const dStr = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
                const hasEvent = db.events[dStr] && db.events[dStr].length > 0;
                const isSelected = dStr === selectedDate ? 'active' : '';
                const isToday = dStr === new Date().toISOString().split('T')[0] ? 'cal-today' : '';
                
                body.innerHTML += `
                    <div onclick="selectDate('${dStr}')" class="cal-day ${isSelected} ${isToday}">
                        ${d}
                        ${hasEvent ? '<div class="event-dot"></div>' : ''}
                    </div>
                `;
            }

            document.getElementById('target-date').innerText = selectedDate;

            // Liste des √©v√®nements du jour
            const evList = document.getElementById('day-events');
            evList.innerHTML = (db.events[selectedDate] || []).map((ev, i) => `
                <div class="card flex justify-between items-center bg-white/5 border-none py-3">
                    <div>
                        <span class="text-blue-500 font-sport text-[10px] mr-2">${ev.time}</span>
                        <span class="font-bold text-sm uppercase">${ev.type}</span>
                        <p class="text-xs opacity-50 ml-10">${ev.desc}</p>
                    </div>
                    <button onclick="deleteEv('${selectedDate}', ${i})" class="text-white/20">√ó</button>
                </div>
            `).join('');

            // Junk Food Count (7 derniers jours)
            const count = db.junk.filter(j => {
                const diff = (new Date() - new Date(j.date)) / (1000 * 60 * 60 * 24);
                return diff <= 7;
            }).length;
            document.getElementById('junk-count').innerText = count + " / 2";
            document.getElementById('junk-count').style.color = count > 2 ? '#ff003c' : 'white';

            document.getElementById('junk-history').innerHTML = db.junk.slice(-5).reverse().map(j => `
                <div class="text-[10px] opacity-40 italic">üìÖ ${j.date} : ${j.name}</div>
            `).join('');
        }

        function selectDate(d) { selectedDate = d; render(); }
        function deleteEv(date, index) { db.events[date].splice(index, 1); save(); }

        render();
    </script>
</body>
</html>
